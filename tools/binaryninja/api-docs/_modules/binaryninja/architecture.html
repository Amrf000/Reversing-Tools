

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>binaryninja.architecture &mdash; Binary Ninja API 1.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/css/other.css" type="text/css" />
  

  
    <link rel="top" title="Binary Ninja API 1.1.0 documentation" href="../../index.html"/>
        <link rel="up" title="binaryninja" href="../binaryninja.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> Binary Ninja API
          

          
          </a>

          
            
            
              <div class="version">
                1.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.architecture-module.html">architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.atexit-module.html">atexit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.basicblock-module.html">basicblock</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.binaryview-module.html">binaryview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.callingconvention-module.html">callingconvention</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.databuffer-module.html">databuffer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.demangle-module.html">demangle</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.enums-module.html">enums</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.fileaccessor-module.html">fileaccessor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.filemetadata-module.html">filemetadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.function-module.html">function</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.functionrecognizer-module.html">functionrecognizer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.highlight-module.html">highlight</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.interaction-module.html">interaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.lineardisassembly-module.html">lineardisassembly</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.log-module.html">log</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.lowlevelil-module.html">lowlevelil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.mainthread-module.html">mainthread</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.mediumlevelil-module.html">mediumlevelil</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.metadata-module.html">metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.platform-module.html">platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.plugin-module.html">plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.pluginmanager-module.html">pluginmanager</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.scriptingprovider-module.html">scriptingprovider</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.setting-module.html">setting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.transform-module.html">transform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.types-module.html">types</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.undoaction-module.html">undoaction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../binaryninja.update-module.html">update</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Binary Ninja API</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
          <li><a href="../binaryninja.html">binaryninja</a> &raquo;</li>
        
      <li>binaryninja.architecture</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for binaryninja.architecture</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright (c) 2015-2017 Vector 35 LLC</span>
<span class="c1">#</span>
<span class="c1"># Permission is hereby granted, free of charge, to any person obtaining a copy</span>
<span class="c1"># of this software and associated documentation files (the &quot;Software&quot;), to</span>
<span class="c1"># deal in the Software without restriction, including without limitation the</span>
<span class="c1"># rights to use, copy, modify, merge, publish, distribute, sublicense, and/or</span>
<span class="c1"># sell copies of the Software, and to permit persons to whom the Software is</span>
<span class="c1"># furnished to do so, subject to the following conditions:</span>
<span class="c1">#</span>
<span class="c1"># The above copyright notice and this permission notice shall be included in</span>
<span class="c1"># all copies or substantial portions of the Software.</span>
<span class="c1">#</span>
<span class="c1"># THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span>
<span class="c1"># IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span>
<span class="c1"># FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span>
<span class="c1"># AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span>
<span class="c1"># LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING</span>
<span class="c1"># FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS</span>
<span class="c1"># IN THE SOFTWARE.</span>

<span class="kn">import</span> <span class="nn">traceback</span>
<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">abc</span>

<span class="c1"># Binary Ninja components</span>
<span class="kn">import</span> <span class="nn">_binaryninjacore</span> <span class="k">as</span> <span class="nn">core</span>
<span class="kn">from</span> <span class="nn">enums</span> <span class="k">import</span> <span class="p">(</span><span class="n">Endianness</span><span class="p">,</span> <span class="n">ImplicitRegisterExtend</span><span class="p">,</span> <span class="n">BranchType</span><span class="p">,</span>
	<span class="n">InstructionTextTokenType</span><span class="p">,</span> <span class="n">LowLevelILFlagCondition</span><span class="p">,</span> <span class="n">FlagRole</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">startup</span>
<span class="kn">import</span> <span class="nn">function</span>
<span class="kn">import</span> <span class="nn">lowlevelil</span>
<span class="kn">import</span> <span class="nn">callingconvention</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">log</span>
<span class="kn">import</span> <span class="nn">databuffer</span>
<span class="kn">import</span> <span class="nn">types</span>


<span class="k">class</span> <span class="nc">_ArchitectureMetaClass</span><span class="p">(</span><span class="nb">type</span><span class="p">):</span>
	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">list</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">startup</span><span class="o">.</span><span class="n">_init_plugins</span><span class="p">()</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">archs</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureList</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
			<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Architecture</span><span class="p">(</span><span class="n">archs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
		<span class="n">core</span><span class="o">.</span><span class="n">BNFreeArchitectureList</span><span class="p">(</span><span class="n">archs</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">result</span>

	<span class="k">def</span> <span class="nf">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="n">startup</span><span class="o">.</span><span class="n">_init_plugins</span><span class="p">()</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">archs</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureList</span><span class="p">(</span><span class="n">count</span><span class="p">)</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
				<span class="k">yield</span> <span class="n">Architecture</span><span class="p">(</span><span class="n">archs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
		<span class="k">finally</span><span class="p">:</span>
			<span class="n">core</span><span class="o">.</span><span class="n">BNFreeArchitectureList</span><span class="p">(</span><span class="n">archs</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__getitem__</span><span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">name</span><span class="p">):</span>
		<span class="n">startup</span><span class="o">.</span><span class="n">_init_plugins</span><span class="p">()</span>
		<span class="n">arch</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureByName</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">arch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;&#39;</span><span class="si">%s</span><span class="s2">&#39; is not a valid architecture&quot;</span> <span class="o">%</span> <span class="nb">str</span><span class="p">(</span><span class="n">name</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">Architecture</span><span class="p">(</span><span class="n">arch</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">register</span><span class="p">(</span><span class="n">cls</span><span class="p">):</span>
		<span class="n">startup</span><span class="o">.</span><span class="n">_init_plugins</span><span class="p">()</span>
		<span class="k">if</span> <span class="n">cls</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;architecture &#39;name&#39; is not defined&quot;</span><span class="p">)</span>
		<span class="n">arch</span> <span class="o">=</span> <span class="n">cls</span><span class="p">()</span>
		<span class="n">cls</span><span class="o">.</span><span class="n">_registered_cb</span> <span class="o">=</span> <span class="n">arch</span><span class="o">.</span><span class="n">_cb</span>
		<span class="n">arch</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNRegisterArchitecture</span><span class="p">(</span><span class="n">cls</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">arch</span><span class="o">.</span><span class="n">_cb</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="nb">type</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
		<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
			<span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;attribute &#39;</span><span class="si">%s</span><span class="s2">&#39; is read only&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>


<div class="viewcode-block" id="Architecture"><a class="viewcode-back" href="../../binaryninja.architecture.Architecture.html#binaryninja.architecture.Architecture">[docs]</a><span class="k">class</span> <span class="nc">Architecture</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
	<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">	``class Architecture`` is the parent class for all CPU architectures. Subclasses of Architecture implement assembly,</span>
<span class="sd">	disassembly, IL lifting, and patching.</span>

<span class="sd">	``class Architecture`` has a ``__metaclass__`` with the additional methods ``register``, and supports</span>
<span class="sd">	iteration::</span>

<span class="sd">		&gt;&gt;&gt; #List the architectures</span>
<span class="sd">		&gt;&gt;&gt; list(Architecture)</span>
<span class="sd">		[&lt;arch: aarch64&gt;, &lt;arch: armv7&gt;, &lt;arch: armv7eb&gt;, &lt;arch: mipsel32&gt;, &lt;arch: mips32&gt;, &lt;arch: powerpc&gt;,</span>
<span class="sd">		&lt;arch: x86&gt;, &lt;arch: x86_64&gt;]</span>
<span class="sd">		&gt;&gt;&gt; #Register a new Architecture</span>
<span class="sd">		&gt;&gt;&gt; class MyArch(Architecture):</span>
<span class="sd">		...  name = &quot;MyArch&quot;</span>
<span class="sd">		...</span>
<span class="sd">		&gt;&gt;&gt; MyArch.register()</span>
<span class="sd">		&gt;&gt;&gt; list(Architecture)</span>
<span class="sd">		[&lt;arch: aarch64&gt;, &lt;arch: armv7&gt;, &lt;arch: armv7eb&gt;, &lt;arch: mipsel32&gt;, &lt;arch: mips32&gt;, &lt;arch: powerpc&gt;,</span>
<span class="sd">		&lt;arch: x86&gt;, &lt;arch: x86_64&gt;, &lt;arch: MyArch&gt;]</span>
<span class="sd">		&gt;&gt;&gt;</span>

<span class="sd">	For the purposes of this documentation the variable ``arch`` will be used in the following context ::</span>

<span class="sd">		&gt;&gt;&gt; from binaryninja import *</span>
<span class="sd">		&gt;&gt;&gt; arch = Architecture[&#39;x86&#39;]</span>
<span class="sd">	&quot;&quot;&quot;</span>
	<span class="n">name</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="n">endianness</span> <span class="o">=</span> <span class="n">Endianness</span><span class="o">.</span><span class="n">LittleEndian</span>
	<span class="n">address_size</span> <span class="o">=</span> <span class="mi">8</span>
	<span class="n">default_int_size</span> <span class="o">=</span> <span class="mi">4</span>
	<span class="n">max_instr_length</span> <span class="o">=</span> <span class="mi">16</span>
	<span class="n">opcode_display_length</span> <span class="o">=</span> <span class="mi">8</span>
	<span class="n">regs</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="n">stack_pointer</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="n">link_reg</span> <span class="o">=</span> <span class="kc">None</span>
	<span class="n">global_regs</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">flags</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">flag_write_types</span> <span class="o">=</span> <span class="p">[]</span>
	<span class="n">flag_roles</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="n">flags_required_for_flag_condition</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="n">flags_written_by_flag_write_type</span> <span class="o">=</span> <span class="p">{}</span>
	<span class="n">__metaclass__</span> <span class="o">=</span> <span class="n">_ArchitectureMetaClass</span>
	<span class="n">next_address</span> <span class="o">=</span> <span class="mi">0</span>

<div class="viewcode-block" id="Architecture.__init__"><a class="viewcode-back" href="../../binaryninja.architecture.Architecture.html#binaryninja.architecture.Architecture.__init__">[docs]</a>	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handle</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
		<span class="k">if</span> <span class="n">handle</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">handle_of_type</span><span class="p">(</span><span class="n">handle</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">BNArchitecture</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;endianness&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Endianness</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureEndianness</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;address_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureAddressSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;default_int_size&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureDefaultIntegerSize</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;max_instr_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureMaxInstructionLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;opcode_display_length&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureOpcodeDisplayLength</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;stack_pointer&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
				<span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureStackPointerRegister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">))</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;link_reg&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
				<span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureLinkRegister</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">))</span>

			<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
			<span class="n">regs</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetAllArchitectureRegisters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;regs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
				<span class="n">name</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">regs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="n">info</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">regs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="n">full_width_reg</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">fullWidthRegister</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">regs</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">function</span><span class="o">.</span><span class="n">RegisterInfo</span><span class="p">(</span><span class="n">full_width_reg</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">offset</span><span class="p">,</span>
					<span class="n">ImplicitRegisterExtend</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">),</span> <span class="n">regs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			<span class="n">core</span><span class="o">.</span><span class="n">BNFreeRegisterList</span><span class="p">(</span><span class="n">regs</span><span class="p">)</span>

			<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
			<span class="n">flags</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetAllArchitectureFlags</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_flags</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
				<span class="n">name</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span><span class="p">[</span><span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">name</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
			<span class="n">core</span><span class="o">.</span><span class="n">BNFreeRegisterList</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>

			<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
			<span class="n">types</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetAllArchitectureFlagWriteTypes</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types_by_index</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flag_write_types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
				<span class="n">name</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagWriteTypeName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types_by_index</span><span class="p">[</span><span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">name</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">flag_write_types</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
			<span class="n">core</span><span class="o">.</span><span class="n">BNFreeRegisterList</span><span class="p">(</span><span class="n">types</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_flag_roles</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flag_roles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags&quot;</span><span class="p">]:</span>
				<span class="n">role</span> <span class="o">=</span> <span class="n">FlagRole</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagRole</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">flag</span><span class="p">]))</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flag_roles&quot;</span><span class="p">][</span><span class="n">flag</span><span class="p">]</span> <span class="o">=</span> <span class="n">role</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flag_roles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">flag</span><span class="p">]]</span> <span class="o">=</span> <span class="n">role</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_flags_required_for_flag_condition</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags_required_for_flag_condition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="n">LowLevelILFlagCondition</span><span class="p">:</span>
				<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
				<span class="n">flags</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagsRequiredForFlagCondition</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
				<span class="n">flag_indexes</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="n">flag_names</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
					<span class="n">flag_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
					<span class="n">flag_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span><span class="p">[</span><span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
				<span class="n">core</span><span class="o">.</span><span class="n">BNFreeRegisterList</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flags_required_for_flag_condition</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag_indexes</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags_required_for_flag_condition&quot;</span><span class="p">][</span><span class="n">cond</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag_names</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_flags_written_by_flag_write_type</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags_written_by_flag_write_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="k">for</span> <span class="n">write_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">flag_write_types</span><span class="p">:</span>
				<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
				<span class="n">flags</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagsWrittenByFlagWriteType</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span><span class="p">[</span><span class="n">write_type</span><span class="p">],</span> <span class="n">count</span><span class="p">)</span>
				<span class="n">flag_indexes</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="n">flag_names</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
					<span class="n">flag_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
					<span class="n">flag_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span><span class="p">[</span><span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
				<span class="n">core</span><span class="o">.</span><span class="n">BNFreeRegisterList</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flags_written_by_flag_write_type</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span><span class="p">[</span><span class="n">write_type</span><span class="p">]]</span> <span class="o">=</span> <span class="n">flag_indexes</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags_written_by_flag_write_type&quot;</span><span class="p">][</span><span class="n">write_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag_names</span>

			<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
			<span class="n">regs</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureGlobalRegisters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;global_regs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">global_regs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">regs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
			<span class="n">core</span><span class="o">.</span><span class="n">BNFreeRegisterList</span><span class="p">(</span><span class="n">regs</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="n">startup</span><span class="o">.</span><span class="n">_init_plugins</span><span class="p">()</span>

			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">opcode_display_length</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">max_instr_length</span><span class="p">:</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">opcode_display_length</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">max_instr_length</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNCustomArchitecture</span><span class="p">()</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">init</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">init</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_init</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getEndianness</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getEndianness</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_endianness</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAddressSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAddressSize</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_address_size</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getDefaultIntegerSize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getDefaultIntegerSize</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_default_integer_size</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getMaxInstructionLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getMaxInstructionLength</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_max_instruction_length</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getOpcodeDisplayLength</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getOpcodeDisplayLength</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_opcode_display_length</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAssociatedArchitectureByAddress</span> <span class="o">=</span> \
				<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAssociatedArchitectureByAddress</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_associated_arch_by_address</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getInstructionInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getInstructionInfo</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_instruction_info</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getInstructionText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getInstructionText</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_instruction_text</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">freeInstructionText</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">freeInstructionText</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_free_instruction_text</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getInstructionLowLevelIL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getInstructionLowLevelIL</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_get_instruction_low_level_il</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getRegisterName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getRegisterName</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_register_name</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagName</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_flag_name</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagWriteTypeName</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagWriteTypeName</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_flag_write_type_name</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFullWidthRegisters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFullWidthRegisters</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_full_width_registers</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAllRegisters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAllRegisters</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_all_registers</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAllFlags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAllRegisters</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_all_flags</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAllFlagWriteTypes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getAllRegisters</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_all_flag_write_types</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagRole</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagRole</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_flag_role</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagsRequiredForFlagCondition</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagsRequiredForFlagCondition</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_get_flags_required_for_flag_condition</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagsWrittenByFlagWriteType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagsWrittenByFlagWriteType</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_get_flags_written_by_flag_write_type</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagWriteLowLevelIL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagWriteLowLevelIL</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_get_flag_write_low_level_il</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagConditionLowLevelIL</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getFlagConditionLowLevelIL</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_get_flag_condition_low_level_il</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">freeRegisterList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">freeRegisterList</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_free_register_list</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getRegisterInfo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getRegisterInfo</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_register_info</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getStackPointerRegister</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getStackPointerRegister</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_get_stack_pointer_register</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getLinkRegister</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getLinkRegister</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_link_register</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getGlobalRegisters</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">getGlobalRegisters</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_get_global_registers</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">assemble</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">assemble</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_assemble</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isNeverBranchPatchAvailable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isNeverBranchPatchAvailable</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_is_never_branch_patch_available</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isAlwaysBranchPatchAvailable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isAlwaysBranchPatchAvailable</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_is_always_branch_patch_available</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isInvertBranchPatchAvailable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isInvertBranchPatchAvailable</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_is_invert_branch_patch_available</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isSkipAndReturnZeroPatchAvailable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isSkipAndReturnZeroPatchAvailable</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_is_skip_and_return_zero_patch_available</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isSkipAndReturnValuePatchAvailable</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">isSkipAndReturnValuePatchAvailable</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_is_skip_and_return_value_patch_available</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">convertToNop</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">convertToNop</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_convert_to_nop</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">alwaysBranch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">alwaysBranch</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_always_branch</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">invertBranch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">invertBranch</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_invert_branch</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">skipAndReturnValue</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cb</span><span class="o">.</span><span class="n">skipAndReturnValue</span><span class="o">.</span><span class="n">__class__</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_skip_and_return_value</span><span class="p">)</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_full_width_regs</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_regs_by_index</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;regs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">regs</span>
			<span class="n">reg_index</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">for</span> <span class="n">reg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">regs</span><span class="p">:</span>
				<span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regs</span><span class="p">[</span><span class="n">reg</span><span class="p">]</span>
				<span class="k">if</span> <span class="n">reg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">[</span><span class="n">reg</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg_index</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_regs_by_index</span><span class="p">[</span><span class="n">reg_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">regs</span><span class="p">[</span><span class="n">reg</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">reg_index</span>
					<span class="n">reg_index</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">full_width_reg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">full_width_reg</span><span class="p">]</span> <span class="o">=</span> <span class="n">reg_index</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_regs_by_index</span><span class="p">[</span><span class="n">reg_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">full_width_reg</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">regs</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">full_width_reg</span><span class="p">]</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">reg_index</span>
					<span class="n">reg_index</span> <span class="o">+=</span> <span class="mi">1</span>
				<span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">full_width_reg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_width_regs</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_full_width_regs</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">full_width_reg</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">full_width_reg</span><span class="p">]</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_flags</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flags</span>
			<span class="n">flag_index</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flags</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">flag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag_index</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span><span class="p">[</span><span class="n">flag_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">flag</span>
					<span class="n">flag_index</span> <span class="o">+=</span> <span class="mi">1</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types_by_index</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flag_write_types&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flag_write_types</span>
			<span class="n">write_type_index</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">for</span> <span class="n">write_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flag_write_types</span><span class="p">:</span>
				<span class="k">if</span> <span class="n">write_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span><span class="p">:</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span><span class="p">[</span><span class="n">write_type</span><span class="p">]</span> <span class="o">=</span> <span class="n">write_type_index</span>
					<span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types_by_index</span><span class="p">[</span><span class="n">write_type_index</span><span class="p">]</span> <span class="o">=</span> <span class="n">write_type</span>
					<span class="n">write_type_index</span> <span class="o">+=</span> <span class="mi">1</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_flag_roles</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flag_roles&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flag_roles</span>
			<span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flag_roles</span><span class="p">:</span>
				<span class="n">role</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flag_roles</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">role</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
					<span class="n">role</span> <span class="o">=</span> <span class="n">FlagRole</span><span class="p">[</span><span class="n">role</span><span class="p">]</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flag_roles</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">flag</span><span class="p">]]</span> <span class="o">=</span> <span class="n">role</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_flags_required_for_flag_condition</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags_required_for_flag_condition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flags_required_for_flag_condition</span>
			<span class="k">for</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flags_required_for_flag_condition</span><span class="p">:</span>
				<span class="n">flags</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flags_required_for_flag_condition</span><span class="p">[</span><span class="n">cond</span><span class="p">]:</span>
					<span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">flag</span><span class="p">])</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flags_required_for_flag_condition</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span> <span class="o">=</span> <span class="n">flags</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_flags_written_by_flag_write_type</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;flags_written_by_flag_write_type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flags_written_by_flag_write_type</span>
			<span class="k">for</span> <span class="n">write_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flags_written_by_flag_write_type</span><span class="p">:</span>
				<span class="n">flags</span> <span class="o">=</span> <span class="p">[]</span>
				<span class="k">for</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">flags_written_by_flag_write_type</span><span class="p">[</span><span class="n">write_type</span><span class="p">]:</span>
					<span class="n">flags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">flag</span><span class="p">])</span>
				<span class="bp">self</span><span class="o">.</span><span class="n">_flags_written_by_flag_write_type</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span><span class="p">[</span><span class="n">write_type</span><span class="p">]]</span> <span class="o">=</span> <span class="n">flags</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">__dict__</span><span class="p">[</span><span class="s2">&quot;global_regs&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">global_regs</span>

			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span> <span class="o">=</span> <span class="p">{}</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_token_lists</span> <span class="o">=</span> <span class="p">{}</span></div>

	<span class="k">def</span> <span class="nf">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Architecture</span><span class="p">):</span>
			<span class="k">return</span> <span class="kc">False</span>
		<span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">addressof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span> <span class="o">==</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">addressof</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">handle</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__ne__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">Architecture</span><span class="p">):</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">addressof</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span> <span class="o">!=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">addressof</span><span class="p">(</span><span class="n">value</span><span class="o">.</span><span class="n">handle</span><span class="o">.</span><span class="n">contents</span><span class="p">)</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">full_width_regs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;List of full width register strings (read-only)&quot;&quot;&quot;</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">regs</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetFullWidthArchitectureRegisters</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
			<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">regs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
		<span class="n">core</span><span class="o">.</span><span class="n">BNFreeRegisterList</span><span class="p">(</span><span class="n">regs</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">result</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">calling_conventions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Dict of CallingConvention objects (read-only)&quot;&quot;&quot;</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">cc</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureCallingConventions</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
			<span class="n">obj</span> <span class="o">=</span> <span class="n">callingconvention</span><span class="o">.</span><span class="n">CallingConvention</span><span class="p">(</span><span class="n">handle</span><span class="o">=</span><span class="n">core</span><span class="o">.</span><span class="n">BNNewCallingConventionReference</span><span class="p">(</span><span class="n">cc</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
			<span class="n">result</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
		<span class="n">core</span><span class="o">.</span><span class="n">BNFreeCallingConventionList</span><span class="p">(</span><span class="n">cc</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">result</span>

	<span class="nd">@property</span>
	<span class="k">def</span> <span class="nf">standalone_platform</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;Architecture standalone platform (read-only)&quot;&quot;&quot;</span>
		<span class="n">pl</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureStandalonePlatform</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">platform</span><span class="o">.</span><span class="n">Platform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pl</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">if</span> <span class="p">((</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;name&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;endianness&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;address_size&quot;</span><span class="p">)</span> <span class="ow">or</span>
			<span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;default_int_size&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;regs&quot;</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;get_max_instruction_length&quot;</span><span class="p">)):</span>
			<span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;attribute &#39;</span><span class="si">%s</span><span class="s2">&#39; is read only&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">try</span><span class="p">:</span>
				<span class="nb">object</span><span class="o">.</span><span class="n">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
			<span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="s2">&quot;attribute &#39;</span><span class="si">%s</span><span class="s2">&#39; is read only&quot;</span> <span class="o">%</span> <span class="n">name</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">return</span> <span class="s2">&quot;&lt;arch: </span><span class="si">%s</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span>

	<span class="k">def</span> <span class="nf">_init</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">handle</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">handle</span> <span class="o">=</span> <span class="n">handle</span>

	<span class="k">def</span> <span class="nf">_get_endianness</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">endianness</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="n">Endianness</span><span class="o">.</span><span class="n">LittleEndian</span>

	<span class="k">def</span> <span class="nf">_get_address_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">address_size</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="mi">8</span>

	<span class="k">def</span> <span class="nf">_get_default_integer_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">default_int_size</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="mi">4</span>

	<span class="k">def</span> <span class="nf">_get_max_instruction_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">max_instr_length</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="mi">16</span>

	<span class="k">def</span> <span class="nf">_get_opcode_display_length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">opcode_display_length</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="mi">8</span>

	<span class="k">def</span> <span class="nf">_get_associated_arch_by_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">result</span><span class="p">,</span> <span class="n">new_addr</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_get_associated_arch_by_address</span><span class="p">(</span><span class="n">addr</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">addr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_addr</span>
			<span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span><span class="o">.</span><span class="n">value</span>

	<span class="k">def</span> <span class="nf">_get_instruction_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">max_len</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">max_len</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">max_len</span><span class="p">)</span>
			<span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_get_instruction_info</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="kc">False</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">length</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">branchDelay</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">branch_delay</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">branchCount</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">branches</span><span class="p">)</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">branches</span><span class="p">)):</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
					<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">branchType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">BranchType</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">branchType</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
				<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">branchTarget</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">target</span>
				<span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">arch</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
					<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">branchArch</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">branchArch</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">branches</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">arch</span><span class="o">.</span><span class="n">handle</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_get_instruction_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_get_instruction_text</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">info</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="kc">False</span>
			<span class="n">tokens</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
			<span class="n">length</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">info</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
			<span class="n">token_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNInstructionTextToken</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">))()</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">tokens</span><span class="p">)):</span>
				<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
					<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">InstructionTextTokenType</span><span class="p">[</span><span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">]</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span>
				<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
				<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
				<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
				<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">operand</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">operand</span>
				<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">context</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">context</span>
				<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">confidence</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">confidence</span>
				<span class="n">token_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">address</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">token_buf</span>
			<span class="n">ptr</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">token_buf</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_token_lists</span><span class="p">[</span><span class="n">ptr</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ptr</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">token_buf</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_free_instruction_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">buf</span><span class="o">.</span><span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_token_lists</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;freeing token list that wasn&#39;t allocated&quot;</span><span class="p">)</span>
			<span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_token_lists</span><span class="p">[</span><span class="n">buf</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

	<span class="k">def</span> <span class="nf">_get_instruction_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
			<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_get_instruction_low_level_il</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span>
				<span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">BNNewLowLevelILFunctionReference</span><span class="p">(</span><span class="n">il</span><span class="p">)))</span>
			<span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="kc">False</span>
			<span class="n">length</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_get_register_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">reg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regs_by_index</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_regs_by_index</span><span class="p">[</span><span class="n">reg</span><span class="p">])</span>
			<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_flag_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span><span class="p">[</span><span class="n">flag</span><span class="p">])</span>
			<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_flag_write_type_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">write_type</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">write_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types_by_index</span><span class="p">:</span>
				<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types_by_index</span><span class="p">[</span><span class="n">write_type</span><span class="p">])</span>
			<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

	<span class="k">def</span> <span class="nf">_get_full_width_registers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">regs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_full_width_regs</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">regs</span><span class="p">)</span>
			<span class="n">reg_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">regs</span><span class="p">))()</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">regs</span><span class="p">)):</span>
				<span class="n">reg_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">regs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">reg_buf</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">reg_buf</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">_get_all_registers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">regs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regs_by_index</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">regs</span><span class="p">)</span>
			<span class="n">reg_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">regs</span><span class="p">))()</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">regs</span><span class="p">)):</span>
				<span class="n">reg_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">regs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">reg_buf</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">reg_buf</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">_get_all_flags</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
			<span class="n">flag_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">))()</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)):</span>
				<span class="n">flag_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">flag_buf</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">flag_buf</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">_get_all_flag_write_types</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">types</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types_by_index</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)</span>
			<span class="n">type_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">))()</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">types</span><span class="p">)):</span>
				<span class="n">type_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">types</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">type_buf</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">type_buf</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">_get_flag_role</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">flag</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_roles</span><span class="p">:</span>
				<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_roles</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span>
			<span class="k">return</span> <span class="n">FlagRole</span><span class="o">.</span><span class="n">SpecialFlagRole</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">_get_flags_required_for_flag_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">cond</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags_required_for_flag_condition</span><span class="p">:</span>
				<span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags_required_for_flag_condition</span><span class="p">[</span><span class="n">cond</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">flags</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
			<span class="n">flag_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">))()</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)):</span>
				<span class="n">flag_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">flag_buf</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">flag_buf</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">_get_flags_written_by_flag_write_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">write_type</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">write_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags_written_by_flag_write_type</span><span class="p">:</span>
				<span class="n">flags</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags_written_by_flag_write_type</span><span class="p">[</span><span class="n">write_type</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">flags</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
			<span class="n">flag_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">))()</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">flags</span><span class="p">)):</span>
				<span class="n">flag_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">flags</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">flag_buf</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">flag_buf</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">_get_flag_write_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">write_type</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">operands</span><span class="p">,</span> <span class="n">operand_count</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">write_type_name</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="k">if</span> <span class="n">write_type</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
				<span class="n">write_type_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types_by_index</span><span class="p">[</span><span class="n">write_type</span><span class="p">]</span>
			<span class="n">flag_name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags_by_index</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span>
			<span class="n">operand_list</span> <span class="o">=</span> <span class="p">[]</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="n">operand_count</span><span class="p">):</span>
				<span class="k">if</span> <span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">constant</span><span class="p">:</span>
					<span class="n">operand_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
				<span class="k">elif</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">LLIL_REG_IS_TEMP</span><span class="p">(</span><span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span><span class="p">):</span>
					<span class="n">operand_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lowlevelil</span><span class="o">.</span><span class="n">ILRegister</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span><span class="p">))</span>
				<span class="k">else</span><span class="p">:</span>
					<span class="n">operand_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lowlevelil</span><span class="o">.</span><span class="n">ILRegister</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span><span class="p">))</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_get_flag_write_low_level_il</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">write_type_name</span><span class="p">,</span> <span class="n">flag_name</span><span class="p">,</span> <span class="n">operand_list</span><span class="p">,</span>
				<span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">BNNewLowLevelILFunctionReference</span><span class="p">(</span><span class="n">il</span><span class="p">)))</span><span class="o">.</span><span class="n">index</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">OSError</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_get_flag_condition_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_get_flag_condition_low_level_il</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span>
				<span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">core</span><span class="o">.</span><span class="n">BNNewLowLevelILFunctionReference</span><span class="p">(</span><span class="n">il</span><span class="p">)))</span><span class="o">.</span><span class="n">index</span>
		<span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="mi">0</span>

	<span class="k">def</span> <span class="nf">_free_register_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">regs</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">regs</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">buf</span><span class="o">.</span><span class="n">value</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">:</span>
				<span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;freeing register list that wasn&#39;t allocated&quot;</span><span class="p">)</span>
			<span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">[</span><span class="n">buf</span><span class="o">.</span><span class="n">value</span><span class="p">]</span>
		<span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">KeyError</span><span class="p">):</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>

	<span class="k">def</span> <span class="nf">_get_register_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">result</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="n">reg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_regs_by_index</span><span class="p">:</span>
				<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fullWidthRegister</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
				<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span> <span class="o">=</span> <span class="n">ImplicitRegisterExtend</span><span class="o">.</span><span class="n">NoExtend</span>
				<span class="k">return</span>
			<span class="n">info</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">regs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">_regs_by_index</span><span class="p">[</span><span class="n">reg</span><span class="p">]]</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fullWidthRegister</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">full_width_reg</span><span class="p">]</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">offset</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">size</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
				<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span> <span class="o">=</span> <span class="n">ImplicitRegisterExtend</span><span class="p">[</span><span class="n">info</span><span class="o">.</span><span class="n">extend</span><span class="p">]</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">extend</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">fullWidthRegister</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">offset</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">extend</span> <span class="o">=</span> <span class="n">ImplicitRegisterExtend</span><span class="o">.</span><span class="n">NoExtend</span>

	<span class="k">def</span> <span class="nf">_get_stack_pointer_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">stack_pointer</span><span class="p">]</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="mi">0</span>

	<span class="k">def</span> <span class="nf">_get_link_register</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">link_reg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="mh">0xffffffff</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">link_reg</span><span class="p">]</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="mi">0</span>

	<span class="k">def</span> <span class="nf">_get_global_registers</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">global_regs</span><span class="p">)</span>
			<span class="n">reg_buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_uint</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">global_regs</span><span class="p">))()</span>
			<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">global_regs</span><span class="p">)):</span>
				<span class="n">reg_buf</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_all_regs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">__class__</span><span class="o">.</span><span class="n">global_regs</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span>
			<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">cast</span><span class="p">(</span><span class="n">reg_buf</span><span class="p">,</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_void_p</span><span class="p">)</span>
			<span class="bp">self</span><span class="o">.</span><span class="n">_pending_reg_lists</span><span class="p">[</span><span class="n">result</span><span class="o">.</span><span class="n">value</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">reg_buf</span><span class="p">)</span>
			<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">value</span>
		<span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">count</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
			<span class="k">return</span> <span class="kc">None</span>

	<span class="k">def</span> <span class="nf">_assemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="n">errors</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">data</span><span class="p">,</span> <span class="n">error_str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_assemble</span><span class="p">(</span><span class="n">code</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
			<span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">error_str</span><span class="p">))</span>
			<span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="kc">False</span>
			<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
			<span class="n">core</span><span class="o">.</span><span class="n">BNSetDataBufferContents</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="n">errors</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAllocString</span><span class="p">(</span><span class="s2">&quot;Unhandled exception during assembly.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_is_never_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_is_never_branch_patch_available</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_is_always_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_is_always_branch_patch_available</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_is_invert_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_is_invert_branch_patch_available</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_is_skip_and_return_zero_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_is_skip_and_return_zero_patch_available</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_is_skip_and_return_value_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_is_skip_and_return_value_patch_available</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_convert_to_nop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_convert_to_nop</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="kc">False</span>
			<span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
				<span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">length</span><span class="p">]</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_always_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_always_branch</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="kc">False</span>
			<span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
				<span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">length</span><span class="p">]</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_invert_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_invert_branch</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="kc">False</span>
			<span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
				<span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">length</span><span class="p">]</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

	<span class="k">def</span> <span class="nf">_skip_and_return_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ctxt</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="k">try</span><span class="p">:</span>
			<span class="n">buf</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="n">length</span><span class="p">)</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">length</span><span class="p">)</span>
			<span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">perform_skip_and_return_value</span><span class="p">(</span><span class="n">buf</span><span class="o">.</span><span class="n">raw</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
			<span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
				<span class="k">return</span> <span class="kc">False</span>
			<span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
			<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">length</span><span class="p">:</span>
				<span class="n">result</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">length</span><span class="p">]</span>
			<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">result</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">))</span>
			<span class="k">return</span> <span class="kc">True</span>
		<span class="k">except</span><span class="p">:</span>
			<span class="n">log</span><span class="o">.</span><span class="n">log_error</span><span class="p">(</span><span class="n">traceback</span><span class="o">.</span><span class="n">format_exc</span><span class="p">())</span>
			<span class="k">return</span> <span class="kc">False</span>

<div class="viewcode-block" id="Architecture.perform_get_associated_arch_by_address"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_get_associated_arch_by_address">[docs]</a>	<span class="k">def</span> <span class="nf">perform_get_associated_arch_by_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="k">return</span> <span class="bp">self</span><span class="p">,</span> <span class="n">addr</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_get_instruction_info"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_get_instruction_info">[docs]</a>	<span class="k">def</span> <span class="nf">perform_get_instruction_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_get_instruction_info`` implements a method which interpretes the bytes passed in ``data`` as an</span>
<span class="sd">		:py:Class:`InstructionInfo` object. The InstructionInfo object should have the length of the current instruction.</span>
<span class="sd">		If the instruction is a branch instruction the method should add a branch of the proper type:</span>

<span class="sd">			===================== ===================================================</span>
<span class="sd">			BranchType            Description</span>
<span class="sd">			===================== ===================================================</span>
<span class="sd">			UnconditionalBranch   Branch will always be taken</span>
<span class="sd">			FalseBranch           False branch condition</span>
<span class="sd">			TrueBranch            True branch condition</span>
<span class="sd">			CallDestination       Branch is a call instruction (Branch with Link)</span>
<span class="sd">			FunctionReturn        Branch returns from a function</span>
<span class="sd">			SystemCall            System call instruction</span>
<span class="sd">			IndirectBranch        Branch destination is a memory address or register</span>
<span class="sd">			UnresolvedBranch      Call instruction that isn&#39;t</span>
<span class="sd">			===================== ===================================================</span>

<span class="sd">		:param str data: bytes to decode</span>
<span class="sd">		:param int addr: virtual address of the byte to be decoded</span>
<span class="sd">		:return: a :py:class:`InstructionInfo` object containing the length and branche types for the given instruction</span>
<span class="sd">		:rtype: InstructionInfo</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_get_instruction_text"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_get_instruction_text">[docs]</a>	<span class="k">def</span> <span class="nf">perform_get_instruction_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_get_instruction_text`` implements a method which interpretes the bytes passed in ``data`` as a</span>
<span class="sd">		list of :py:class:`InstructionTextToken` objects.</span>

<span class="sd">		:param str data: bytes to decode</span>
<span class="sd">		:param int addr: virtual address of the byte to be decoded</span>
<span class="sd">		:return: a tuple of list(InstructionTextToken) and length of instruction decoded</span>
<span class="sd">		:rtype: tuple(list(InstructionTextToken), int)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_get_instruction_low_level_il"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_get_instruction_low_level_il">[docs]</a>	<span class="k">def</span> <span class="nf">perform_get_instruction_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_get_instruction_low_level_il`` implements a method to interpret the bytes passed in ``data`` to</span>
<span class="sd">		low-level IL instructions. The il instructions must be appended to the :py:class:`LowLevelILFunction`.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>

<span class="sd">		:param str data: bytes to be interpreted as low-level IL instructions</span>
<span class="sd">		:param int addr: virtual address of start of ``data``</span>
<span class="sd">		:param LowLevelILFunction il: LowLevelILFunction object to append LowLevelILExpr objects to</span>
<span class="sd">		:rtype: length of bytes read on success, None on failure</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">raise</span> <span class="ne">NotImplementedError</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_get_flag_write_low_level_il"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_get_flag_write_low_level_il">[docs]</a>	<span class="k">def</span> <span class="nf">perform_get_flag_write_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">write_type</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">operands</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param LowLevelILOperation op:</span>
<span class="sd">		:param int size:</span>
<span class="sd">		:param int write_type:</span>
<span class="sd">		:param int flag:</span>
<span class="sd">		:param list(int_or_str):</span>
<span class="sd">		:param LowLevelILFunction il:</span>
<span class="sd">		:rtype: LowLevelILExpr</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flag_index</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
		<span class="k">if</span> <span class="n">flag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_roles</span><span class="p">:</span>
			<span class="k">return</span> <span class="n">il</span><span class="o">.</span><span class="n">unimplemented</span><span class="p">()</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_flag_write_low_level_il</span><span class="p">(</span><span class="n">op</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_roles</span><span class="p">[</span><span class="n">flag</span><span class="p">],</span> <span class="n">operands</span><span class="p">,</span> <span class="n">il</span><span class="p">)</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_get_flag_condition_low_level_il"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_get_flag_condition_low_level_il">[docs]</a>	<span class="k">def</span> <span class="nf">perform_get_flag_condition_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param LowLevelILFlagCondition cond:</span>
<span class="sd">		:param LowLevelILFunction il:</span>
<span class="sd">		:rtype: LowLevelILExpr</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_default_flag_condition_low_level_il</span><span class="p">(</span><span class="n">cond</span><span class="p">,</span> <span class="n">il</span><span class="p">)</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_assemble"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_assemble">[docs]</a>	<span class="k">def</span> <span class="nf">perform_assemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_assemble`` implements a method to convert the string of assembly instructions ``code`` loaded at</span>
<span class="sd">		virtual address ``addr`` to the byte representation of those instructions. This can be done by simply shelling</span>
<span class="sd">		out to an assembler like yasm or llvm-mc, since this method isn&#39;t performance sensitive.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. note :: It is important that the assembler used accepts a syntax identical to the one emitted by the \</span>
<span class="sd">		disassembler. This will prevent confusing the user.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str code: string representation of the instructions to be assembled</span>
<span class="sd">		:param int addr: virtual address that the instructions will be loaded at</span>
<span class="sd">		:return: the bytes for the assembled instructions or error string</span>
<span class="sd">		:rtype: (a tuple of instructions and empty string) or (or None and error string)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">&quot;Architecture does not implement an assembler.</span><span class="se">\n</span><span class="s2">&quot;</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_is_never_branch_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_is_never_branch_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">perform_is_never_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_is_never_branch_patch_available`` implements a check to determine if the instruction represented by</span>
<span class="sd">		the bytes contained in ``data`` at address addr is a branch instruction that can be made to never branch.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str data: bytes to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">False</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_is_always_branch_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_is_always_branch_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">perform_is_always_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_is_always_branch_patch_available`` implements a check to determine if the instruction represented by</span>
<span class="sd">		the bytes contained in ``data`` at address addr is a conditional branch that can be made unconditional.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str data: bytes to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">False</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_is_invert_branch_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_is_invert_branch_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">perform_is_invert_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_is_invert_branch_patch_available`` implements a check to determine if the instruction represented by</span>
<span class="sd">		the bytes contained in ``data`` at address addr is a conditional branch which can be inverted.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">False</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_is_skip_and_return_zero_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_is_skip_and_return_zero_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">perform_is_skip_and_return_zero_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_is_skip_and_return_zero_patch_available`` implements a check to determine if the instruction represented by</span>
<span class="sd">		the bytes contained in ``data`` at address addr is a *call-like* instruction which can made into instructions</span>
<span class="sd">		that are equivilent to &quot;return 0&quot;. For example if ``data`` was the x86 instruction ``call eax`` which could be</span>
<span class="sd">		converted into ``xor eax,eax`` thus this function would return True.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str data: bytes to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">False</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_is_skip_and_return_value_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_is_skip_and_return_value_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">perform_is_skip_and_return_value_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_is_skip_and_return_value_patch_available`` implements a check to determine if the instruction represented by</span>
<span class="sd">		the bytes contained in ``data`` at address addr is a *call-like* instruction which can made into instructions</span>
<span class="sd">		that are equivilent to &quot;return 0&quot;. For example if ``data`` was the x86 instruction ``call 0xdeadbeef`` which could be</span>
<span class="sd">		converted into ``mov eax, 42`` thus this function would return True.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str data: bytes to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">False</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_convert_to_nop"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_convert_to_nop">[docs]</a>	<span class="k">def</span> <span class="nf">perform_convert_to_nop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_convert_to_nop`` implements a method which returns a nop sequence of len(data) bytes long.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str data: bytes at virtual address ``addr``</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: nop sequence of same length as ``data`` or None</span>
<span class="sd">		:rtype: str or None</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">None</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_always_branch"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_always_branch">[docs]</a>	<span class="k">def</span> <span class="nf">perform_always_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_always_branch`` implements a method which converts the branch represented by the bytes in ``data`` to</span>
<span class="sd">		at ``addr`` to an unconditional branch.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str data: bytes to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: The bytes of the replacement unconditional branch instruction</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">None</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_invert_branch"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_invert_branch">[docs]</a>	<span class="k">def</span> <span class="nf">perform_invert_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_invert_branch`` implements a method which inverts the branch represented by the bytes in ``data`` to</span>
<span class="sd">		at ``addr``.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str data: bytes to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: The bytes of the replacement unconditional branch instruction</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">None</span></div>

	<span class="nd">@abc</span><span class="o">.</span><span class="n">abstractmethod</span>
<div class="viewcode-block" id="Architecture.perform_skip_and_return_value"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.perform_skip_and_return_value">[docs]</a>	<span class="k">def</span> <span class="nf">perform_skip_and_return_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``perform_skip_and_return_value`` implements a method which converts a *call-like* instruction represented by</span>
<span class="sd">		the bytes in ``data`` at ``addr`` to one or more instructions that are equivilent to a function returning a</span>
<span class="sd">		value.</span>

<span class="sd">		.. note:: Architecture subclasses should implement this method.</span>
<span class="sd">		.. warning:: This method should never be called directly.</span>

<span class="sd">		:param str data: bytes to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:param int value: value to be returned</span>
<span class="sd">		:return: The bytes of the replacement unconditional branch instruction</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="kc">None</span></div>

<div class="viewcode-block" id="Architecture.get_associated_arch_by_address"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_associated_arch_by_address">[docs]</a>	<span class="k">def</span> <span class="nf">get_associated_arch_by_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="n">new_addr</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">new_addr</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">addr</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetAssociatedArchitectureByAddress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">new_addr</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">Architecture</span><span class="p">(</span><span class="n">handle</span> <span class="o">=</span> <span class="n">result</span><span class="p">),</span> <span class="n">new_addr</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="Architecture.get_instruction_info"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_instruction_info">[docs]</a>	<span class="k">def</span> <span class="nf">get_instruction_info</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_instruction_info`` returns an InstructionInfo object for the instruction at the given virtual address</span>
<span class="sd">		``addr`` with data ``data``.</span>

<span class="sd">		.. note :: The instruction info object should always set the InstructionInfo.length to the instruction length, \</span>
<span class="sd">		and the branches of the proper types shoulde be added if the instruction is a branch.</span>

<span class="sd">		:param str data: max_instruction_length bytes from the binary at virtual address ``addr``</span>
<span class="sd">		:param int addr: virtual address of bytes in ``data``</span>
<span class="sd">		:return: the InstructionInfo for the current instruction</span>
<span class="sd">		:rtype: InstructionInfo</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">info</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNInstructionInfo</span><span class="p">()</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetInstructionInfo</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">info</span><span class="p">):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">function</span><span class="o">.</span><span class="n">InstructionInfo</span><span class="p">()</span>
		<span class="n">result</span><span class="o">.</span><span class="n">length</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">length</span>
		<span class="n">result</span><span class="o">.</span><span class="n">branch_delay</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">branchDelay</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">info</span><span class="o">.</span><span class="n">branchCount</span><span class="p">):</span>
			<span class="n">target</span> <span class="o">=</span> <span class="n">info</span><span class="o">.</span><span class="n">branchTarget</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
			<span class="k">if</span> <span class="n">info</span><span class="o">.</span><span class="n">branchArch</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
				<span class="n">arch</span> <span class="o">=</span> <span class="n">Architecture</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">branchArch</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">arch</span> <span class="o">=</span> <span class="kc">None</span>
			<span class="n">result</span><span class="o">.</span><span class="n">add_branch</span><span class="p">(</span><span class="n">BranchType</span><span class="p">(</span><span class="n">info</span><span class="o">.</span><span class="n">branchType</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> <span class="n">target</span><span class="p">,</span> <span class="n">arch</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Architecture.get_instruction_text"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_instruction_text">[docs]</a>	<span class="k">def</span> <span class="nf">get_instruction_text</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_instruction_text`` returns a list of InstructionTextToken objects for the instruction at the given virtual</span>
<span class="sd">		address ``addr`` with data ``data``.</span>

<span class="sd">		:param str data: max_instruction_length bytes from the binary at virtual address ``addr``</span>
<span class="sd">		:param int addr: virtual address of bytes in ``data``</span>
<span class="sd">		:return: an InstructionTextToken list for the current instruction</span>
<span class="sd">		:rtype: list(InstructionTextToken)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">length</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">length</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="n">tokens</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">POINTER</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNInstructionTextToken</span><span class="p">)()</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetInstructionText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">tokens</span><span class="p">,</span> <span class="n">count</span><span class="p">):</span>
			<span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
			<span class="n">token_type</span> <span class="o">=</span> <span class="n">InstructionTextTokenType</span><span class="p">(</span><span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
			<span class="n">text</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span>
			<span class="n">value</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span>
			<span class="n">size</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">size</span>
			<span class="n">operand</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">operand</span>
			<span class="n">context</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">context</span>
			<span class="n">confidence</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">confidence</span>
			<span class="n">address</span> <span class="o">=</span> <span class="n">tokens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">address</span>
			<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function</span><span class="o">.</span><span class="n">InstructionTextToken</span><span class="p">(</span><span class="n">token_type</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">operand</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">address</span><span class="p">,</span> <span class="n">confidence</span><span class="p">))</span>
		<span class="n">core</span><span class="o">.</span><span class="n">BNFreeInstructionText</span><span class="p">(</span><span class="n">tokens</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">result</span><span class="p">,</span> <span class="n">length</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="Architecture.get_instruction_low_level_il_instruction"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_instruction_low_level_il_instruction">[docs]</a>	<span class="k">def</span> <span class="nf">get_instruction_low_level_il_instruction</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bv</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="n">il</span> <span class="o">=</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="n">data</span> <span class="o">=</span> <span class="n">bv</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">addr</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_instr_length</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">get_instruction_low_level_il</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">il</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">il</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Architecture.get_instruction_low_level_il"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_instruction_low_level_il">[docs]</a>	<span class="k">def</span> <span class="nf">get_instruction_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_instruction_low_level_il`` appends LowLevelILExpr objects to ``il`` for the instruction at the given</span>
<span class="sd">		virtual address ``addr`` with data ``data``.</span>

<span class="sd">		This is used to analyze arbitrary data at an address, if you are working with an existing binary, you likely</span>
<span class="sd">		want to be using ``Function.get_low_level_il_at``.</span>

<span class="sd">		:param str data: max_instruction_length bytes from the binary at virtual address ``addr``</span>
<span class="sd">		:param int addr: virtual address of bytes in ``data``</span>
<span class="sd">		:param LowLevelILFunction il: The function the current instruction belongs to</span>
<span class="sd">		:return: the length of the current instruction</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">length</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">length</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="n">core</span><span class="o">.</span><span class="n">BNGetInstructionLowLevelIL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">length</span><span class="p">,</span> <span class="n">il</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">length</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="Architecture.get_low_level_il_from_bytes"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_low_level_il_from_bytes">[docs]</a>	<span class="k">def</span> <span class="nf">get_low_level_il_from_bytes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_low_level_il_from_bytes`` converts the instruction in bytes to ``il`` at the given virtual address</span>

<span class="sd">		:param str data: the bytes of the instruction</span>
<span class="sd">		:param int addr: virtual address of bytes in ``data``</span>
<span class="sd">		:return: the instruction</span>
<span class="sd">		:rtype: LowLevelILInstruction</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.get_low_level_il_from_bytes(&#39;\xeb\xfe&#39;, 0x40DEAD)</span>
<span class="sd">			&lt;il: jump(0x40dead)&gt;</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">func</span> <span class="o">=</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILFunction</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">get_instruction_low_level_il</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">func</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">func</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></div>

<div class="viewcode-block" id="Architecture.get_reg_name"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_reg_name">[docs]</a>	<span class="k">def</span> <span class="nf">get_reg_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_reg_name`` gets a register name from a register number.</span>

<span class="sd">		:param int reg: register number</span>
<span class="sd">		:return: the corresponding register string</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">reg</span><span class="p">)</span></div>

<div class="viewcode-block" id="Architecture.get_flag_name"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_flag_name">[docs]</a>	<span class="k">def</span> <span class="nf">get_flag_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_flag_name`` gets a flag name from a flag number.</span>

<span class="sd">		:param int reg: register number</span>
<span class="sd">		:return: the corresponding register string</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">flag</span><span class="p">)</span></div>

<div class="viewcode-block" id="Architecture.get_reg_index"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_reg_index">[docs]</a>	<span class="k">def</span> <span class="nf">get_reg_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">regs</span><span class="p">[</span><span class="n">reg</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">reg</span><span class="p">,</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">ILRegister</span><span class="p">):</span>
			<span class="k">return</span> <span class="n">reg</span><span class="o">.</span><span class="n">index</span>
		<span class="k">return</span> <span class="n">reg</span></div>

<div class="viewcode-block" id="Architecture.get_flag_index"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_flag_index">[docs]</a>	<span class="k">def</span> <span class="nf">get_flag_index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
		<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
			<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span>
		<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">flag</span><span class="p">,</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">ILFlag</span><span class="p">):</span>
			<span class="k">return</span> <span class="n">flag</span><span class="o">.</span><span class="n">index</span>
		<span class="k">return</span> <span class="n">flag</span></div>

<div class="viewcode-block" id="Architecture.get_flag_write_type_name"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_flag_write_type_name">[docs]</a>	<span class="k">def</span> <span class="nf">get_flag_write_type_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">write_type</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_flag_write_type_name`` gets the flag write type name for the given flag.</span>

<span class="sd">		:param int write_type: flag</span>
<span class="sd">		:return: flag write type name</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagWriteTypeName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">write_type</span><span class="p">)</span></div>

<div class="viewcode-block" id="Architecture.get_flag_by_name"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_flag_by_name">[docs]</a>	<span class="k">def</span> <span class="nf">get_flag_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">flag</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_flag_by_name`` get flag name for flag index.</span>

<span class="sd">		:param int flag: flag index</span>
<span class="sd">		:return: flag name for flag index</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flags</span><span class="p">[</span><span class="n">flag</span><span class="p">]</span></div>

<div class="viewcode-block" id="Architecture.get_flag_write_type_by_name"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_flag_write_type_by_name">[docs]</a>	<span class="k">def</span> <span class="nf">get_flag_write_type_by_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">write_type</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_flag_write_type_by_name`` gets the flag write type name for the flage write type.</span>

<span class="sd">		:param int write_type: flag write type</span>
<span class="sd">		:return: flag write type</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span><span class="p">[</span><span class="n">write_type</span><span class="p">]</span></div>

<div class="viewcode-block" id="Architecture.get_flag_write_low_level_il"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_flag_write_low_level_il">[docs]</a>	<span class="k">def</span> <span class="nf">get_flag_write_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">write_type</span><span class="p">,</span> <span class="n">flag</span><span class="p">,</span> <span class="n">operands</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		:param LowLevelILOperation op:</span>
<span class="sd">		:param int size:</span>
<span class="sd">		:param str write_type:</span>
<span class="sd">		:param list(str or int) operands: a list of either items that are either string register names or constant \</span>
<span class="sd">		integer values</span>
<span class="sd">		:param LowLevelILFunction il:</span>
<span class="sd">		:rtype: LowLevelILExpr</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">flag</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flag_index</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
		<span class="n">operand_list</span> <span class="o">=</span> <span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNRegisterOrConstant</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">operands</span><span class="p">))()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">operands</span><span class="p">)):</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">False</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regs</span><span class="p">[</span><span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">ILRegister</span><span class="p">):</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">False</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILExpr</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagWriteLowLevelIL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span>
		        <span class="bp">self</span><span class="o">.</span><span class="n">_flag_write_types</span><span class="p">[</span><span class="n">write_type</span><span class="p">],</span> <span class="n">flag</span><span class="p">,</span> <span class="n">operand_list</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">operand_list</span><span class="p">),</span> <span class="n">il</span><span class="o">.</span><span class="n">handle</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.get_default_flag_write_low_level_il"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_default_flag_write_low_level_il">[docs]</a>	<span class="k">def</span> <span class="nf">get_default_flag_write_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">role</span><span class="p">,</span> <span class="n">operands</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		:param LowLevelILOperation op:</span>
<span class="sd">		:param int size:</span>
<span class="sd">		:param FlagRole role:</span>
<span class="sd">		:param list(str or int) operands: a list of either items that are either string register names or constant \</span>
<span class="sd">		integer values</span>
<span class="sd">		:param LowLevelILFunction il:</span>
<span class="sd">		:rtype: LowLevelILExpr index</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">operand_list</span> <span class="o">=</span> <span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNRegisterOrConstant</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">operands</span><span class="p">))()</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">operands</span><span class="p">)):</span>
			<span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">False</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">regs</span><span class="p">[</span><span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">.</span><span class="n">index</span>
			<span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">ILRegister</span><span class="p">):</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">False</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">reg</span> <span class="o">=</span> <span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span>
			<span class="k">else</span><span class="p">:</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">constant</span> <span class="o">=</span> <span class="kc">True</span>
				<span class="n">operand_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">operands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
		<span class="k">return</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILExpr</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetDefaultArchitectureFlagWriteLowLevelIL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">op</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span>
			<span class="n">role</span><span class="p">,</span> <span class="n">operand_list</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">operand_list</span><span class="p">),</span> <span class="n">il</span><span class="o">.</span><span class="n">handle</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.get_flag_condition_low_level_il"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_flag_condition_low_level_il">[docs]</a>	<span class="k">def</span> <span class="nf">get_flag_condition_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		:param LowLevelILFlagCondition cond:</span>
<span class="sd">		:param LowLevelILFunction il:</span>
<span class="sd">		:rtype: LowLevelILExpr</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILExpr</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureFlagConditionLowLevelIL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">il</span><span class="o">.</span><span class="n">handle</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.get_default_flag_condition_low_level_il"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_default_flag_condition_low_level_il">[docs]</a>	<span class="k">def</span> <span class="nf">get_default_flag_condition_low_level_il</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">il</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		:param LowLevelILFlagCondition cond:</span>
<span class="sd">		:param LowLevelILFunction il:</span>
<span class="sd">		:rtype: LowLevelILExpr</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="n">lowlevelil</span><span class="o">.</span><span class="n">LowLevelILExpr</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetDefaultArchitectureFlagConditionLowLevelIL</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">cond</span><span class="p">,</span> <span class="n">il</span><span class="o">.</span><span class="n">handle</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.get_modified_regs_on_write"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_modified_regs_on_write">[docs]</a>	<span class="k">def</span> <span class="nf">get_modified_regs_on_write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">reg</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_modified_regs_on_write`` returns a list of register names that are modified when ``reg`` is written.</span>

<span class="sd">		:param str reg: string register name</span>
<span class="sd">		:return: list of register names</span>
<span class="sd">		:rtype: list(str)</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">reg</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterByName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">reg</span><span class="p">))</span>
		<span class="n">count</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_ulonglong</span><span class="p">()</span>
		<span class="n">regs</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetModifiedArchitectureRegistersOnWrite</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">reg</span><span class="p">,</span> <span class="n">count</span><span class="p">)</span>
		<span class="n">result</span> <span class="o">=</span> <span class="p">[]</span>
		<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">count</span><span class="o">.</span><span class="n">value</span><span class="p">):</span>
			<span class="n">result</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">core</span><span class="o">.</span><span class="n">BNGetArchitectureRegisterName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">regs</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
		<span class="n">core</span><span class="o">.</span><span class="n">BNFreeRegisterList</span><span class="p">(</span><span class="n">regs</span><span class="p">)</span>
		<span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="Architecture.assemble"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.assemble">[docs]</a>	<span class="k">def</span> <span class="nf">assemble</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">addr</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``assemble`` converts the string of assembly instructions ``code`` loaded at virtual address ``addr`` to the</span>
<span class="sd">		byte representation of those instructions.</span>

<span class="sd">		:param str code: string representation of the instructions to be assembled</span>
<span class="sd">		:param int addr: virtual address that the instructions will be loaded at</span>
<span class="sd">		:return: the bytes for the assembled instructions or error string</span>
<span class="sd">		:rtype: (a tuple of instructions and empty string) or (or None and error string)</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.assemble(&quot;je 10&quot;)</span>
<span class="sd">			(&#39;\\x0f\\x84\\x04\\x00\\x00\\x00&#39;, &#39;&#39;)</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">databuffer</span><span class="o">.</span><span class="n">DataBuffer</span><span class="p">()</span>
		<span class="n">errors</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">c_char_p</span><span class="p">()</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">BNAssemble</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">code</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">errors</span><span class="p">):</span>
			<span class="k">return</span> <span class="kc">None</span><span class="p">,</span> <span class="n">errors</span><span class="o">.</span><span class="n">value</span>
		<span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="n">result</span><span class="p">),</span> <span class="n">errors</span><span class="o">.</span><span class="n">value</span></div>

<div class="viewcode-block" id="Architecture.is_never_branch_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.is_never_branch_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">is_never_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``is_never_branch_patch_available`` determines if the instruction ``data`` at ``addr`` can be made to **never branch**.</span>

<span class="sd">		:param str data: bytes for the instruction to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.is_never_branch_patch_available(arch.assemble(&quot;je 10&quot;)[0], 0)</span>
<span class="sd">			True</span>
<span class="sd">			&gt;&gt;&gt; arch.is_never_branch_patch_available(arch.assemble(&quot;nop&quot;)[0], 0)</span>
<span class="sd">			False</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNIsArchitectureNeverBranchPatchAvailable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.is_always_branch_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.is_always_branch_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">is_always_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``is_always_branch_patch_available`` determines if the instruction ``data`` at ``addr`` can be made to</span>
<span class="sd">		**always branch**.</span>

<span class="sd">		:param str data: bytes for the instruction to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.is_always_branch_patch_available(arch.assemble(&quot;je 10&quot;)[0], 0)</span>
<span class="sd">			True</span>
<span class="sd">			&gt;&gt;&gt; arch.is_always_branch_patch_available(arch.assemble(&quot;nop&quot;)[0], 0)</span>
<span class="sd">			False</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNIsArchitectureAlwaysBranchPatchAvailable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.is_invert_branch_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.is_invert_branch_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">is_invert_branch_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``is_always_branch_patch_available`` determines if the instruction ``data`` at ``addr`` can be inverted.</span>

<span class="sd">		:param str data: bytes for the instruction to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.is_invert_branch_patch_available(arch.assemble(&quot;je 10&quot;)[0], 0)</span>
<span class="sd">			True</span>
<span class="sd">			&gt;&gt;&gt; arch.is_invert_branch_patch_available(arch.assemble(&quot;nop&quot;)[0], 0)</span>
<span class="sd">			False</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNIsArchitectureInvertBranchPatchAvailable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.is_skip_and_return_zero_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.is_skip_and_return_zero_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">is_skip_and_return_zero_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``is_skip_and_return_zero_patch_available`` determines if the instruction ``data`` at ``addr`` is a *call-like*</span>
<span class="sd">		instruction that can be made into an instruction *returns zero*.</span>

<span class="sd">		:param str data: bytes for the instruction to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.is_skip_and_return_zero_patch_available(arch.assemble(&quot;call 0&quot;)[0], 0)</span>
<span class="sd">			True</span>
<span class="sd">			&gt;&gt;&gt; arch.is_skip_and_return_zero_patch_available(arch.assemble(&quot;call eax&quot;)[0], 0)</span>
<span class="sd">			True</span>
<span class="sd">			&gt;&gt;&gt; arch.is_skip_and_return_zero_patch_available(arch.assemble(&quot;jmp eax&quot;)[0], 0)</span>
<span class="sd">			False</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNIsArchitectureSkipAndReturnZeroPatchAvailable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.is_skip_and_return_value_patch_available"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.is_skip_and_return_value_patch_available">[docs]</a>	<span class="k">def</span> <span class="nf">is_skip_and_return_value_patch_available</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``is_skip_and_return_zero_patch_available`` determines if the instruction ``data`` at ``addr`` is a *call-like*</span>
<span class="sd">		instruction that can be made into an instruction *returns a value*.</span>

<span class="sd">		:param str data: bytes for the instruction to be checked</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: True if the instruction can be patched, False otherwise</span>
<span class="sd">		:rtype: bool</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.is_skip_and_return_zero_patch_available(arch.assemble(&quot;call 0&quot;)[0], 0)</span>
<span class="sd">			True</span>
<span class="sd">			&gt;&gt;&gt; arch.is_skip_and_return_zero_patch_available(arch.assemble(&quot;jmp eax&quot;)[0], 0)</span>
<span class="sd">			False</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNIsArchitectureSkipAndReturnValuePatchAvailable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span></div>

<div class="viewcode-block" id="Architecture.convert_to_nop"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.convert_to_nop">[docs]</a>	<span class="k">def</span> <span class="nf">convert_to_nop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``convert_to_nop`` reads the instruction(s) in ``data`` at virtual address ``addr`` and returns a string of nop</span>
<span class="sd">		instructions of the same length as data.</span>

<span class="sd">		:param str data: bytes for the instruction to be converted</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: string containing len(data) worth of no-operation instructions</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.convert_to_nop(&quot;\\x00\\x00&quot;, 0)</span>
<span class="sd">			&#39;\\x90\\x90&#39;</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">BNArchitectureConvertToNop</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">raw</span></div>

<div class="viewcode-block" id="Architecture.always_branch"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.always_branch">[docs]</a>	<span class="k">def</span> <span class="nf">always_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``always_branch`` reads the instruction(s) in ``data`` at virtual address ``addr`` and returns a string of bytes</span>
<span class="sd">		of the same length which always branches.</span>

<span class="sd">		:param str data: bytes for the instruction to be converted</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: string containing len(data) which always branches to the same location as the provided instruction</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; bytes = arch.always_branch(arch.assemble(&quot;je 10&quot;)[0], 0)</span>
<span class="sd">			&gt;&gt;&gt; arch.get_instruction_text(bytes, 0)</span>
<span class="sd">			([&#39;nop     &#39;], 1L)</span>
<span class="sd">			&gt;&gt;&gt; arch.get_instruction_text(bytes[1:], 0)</span>
<span class="sd">			([&#39;jmp     &#39;, &#39;0x9&#39;], 5L)</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">BNArchitectureAlwaysBranch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">raw</span></div>

<div class="viewcode-block" id="Architecture.invert_branch"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.invert_branch">[docs]</a>	<span class="k">def</span> <span class="nf">invert_branch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``invert_branch`` reads the instruction(s) in ``data`` at virtual address ``addr`` and returns a string of bytes</span>
<span class="sd">		of the same length which inverts the branch of provided instruction.</span>

<span class="sd">		:param str data: bytes for the instruction to be converted</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: string containing len(data) which always branches to the same location as the provided instruction</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.get_instruction_text(arch.invert_branch(arch.assemble(&quot;je 10&quot;)[0], 0), 0)</span>
<span class="sd">			([&#39;jne     &#39;, &#39;0xa&#39;], 6L)</span>
<span class="sd">			&gt;&gt;&gt; arch.get_instruction_text(arch.invert_branch(arch.assemble(&quot;jo 10&quot;)[0], 0), 0)</span>
<span class="sd">			([&#39;jno     &#39;, &#39;0xa&#39;], 6L)</span>
<span class="sd">			&gt;&gt;&gt; arch.get_instruction_text(arch.invert_branch(arch.assemble(&quot;jge 10&quot;)[0], 0), 0)</span>
<span class="sd">			([&#39;jl      &#39;, &#39;0xa&#39;], 6L)</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">BNArchitectureInvertBranch</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">raw</span></div>

<div class="viewcode-block" id="Architecture.skip_and_return_value"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.skip_and_return_value">[docs]</a>	<span class="k">def</span> <span class="nf">skip_and_return_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``skip_and_return_value`` reads the instruction(s) in ``data`` at virtual address ``addr`` and returns a string of</span>
<span class="sd">		bytes of the same length which doesn&#39;t call and instead *return a value*.</span>

<span class="sd">		:param str data: bytes for the instruction to be converted</span>
<span class="sd">		:param int addr: the virtual address of the instruction to be patched</span>
<span class="sd">		:return: string containing len(data) which always branches to the same location as the provided instruction</span>
<span class="sd">		:rtype: str</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.get_instruction_text(arch.skip_and_return_value(arch.assemble(&quot;call 10&quot;)[0], 0, 0), 0)</span>
<span class="sd">			([&#39;mov     &#39;, &#39;eax&#39;, &#39;, &#39;, &#39;0x0&#39;], 5L)</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">data</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
		<span class="n">buf</span> <span class="o">=</span> <span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_ubyte</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))()</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">buf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">if</span> <span class="ow">not</span> <span class="n">core</span><span class="o">.</span><span class="n">BNArchitectureSkipAndReturnValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="n">addr</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">value</span><span class="p">):</span>
			<span class="k">return</span> <span class="kc">None</span>
		<span class="n">result</span> <span class="o">=</span> <span class="n">ctypes</span><span class="o">.</span><span class="n">create_string_buffer</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="n">ctypes</span><span class="o">.</span><span class="n">memmove</span><span class="p">(</span><span class="n">result</span><span class="p">,</span> <span class="n">buf</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
		<span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">raw</span></div>

<div class="viewcode-block" id="Architecture.is_view_type_constant_defined"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.is_view_type_constant_defined">[docs]</a>	<span class="k">def</span> <span class="nf">is_view_type_constant_defined</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_name</span><span class="p">,</span> <span class="n">const_name</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">		:param str type_name: the BinaryView type name of the constant to query</span>
<span class="sd">		:param str const_name: the constant name to query</span>
<span class="sd">		:rtype: None</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; arch.set_view_type_constant(&quot;ELF&quot;, &quot;R_COPY&quot;, ELF_RELOC_COPY)</span>
<span class="sd">			&gt;&gt;&gt; arch.is_view_type_constant_defined(&quot;ELF&quot;, &quot;R_COPY&quot;)</span>
<span class="sd">			True</span>
<span class="sd">			&gt;&gt;&gt; arch.is_view_type_constant_defined(&quot;ELF&quot;, &quot;NOT_THERE&quot;)</span>
<span class="sd">			False</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNIsBinaryViewTypeArchitectureConstantDefined</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">type_name</span><span class="p">,</span> <span class="n">const_name</span><span class="p">)</span></div>

<div class="viewcode-block" id="Architecture.get_view_type_constant"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.get_view_type_constant">[docs]</a>	<span class="k">def</span> <span class="nf">get_view_type_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_name</span><span class="p">,</span> <span class="n">const_name</span><span class="p">,</span> <span class="n">default_value</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``get_view_type_constant`` retrieves the view type constant for the given type_name and const_name.</span>

<span class="sd">		:param str type_name: the BinaryView type name of the constant to be retrieved</span>
<span class="sd">		:param str const_name: the constant name to retrieved</span>
<span class="sd">		:param int value: optional default value if the type_name is not present. default value is zero.</span>
<span class="sd">		:return: The BinaryView type constant or the default_value if not found</span>
<span class="sd">		:rtype: int</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; ELF_RELOC_COPY = 5</span>
<span class="sd">			&gt;&gt;&gt; arch.set_view_type_constant(&quot;ELF&quot;, &quot;R_COPY&quot;, ELF_RELOC_COPY)</span>
<span class="sd">			&gt;&gt;&gt; arch.get_view_type_constant(&quot;ELF&quot;, &quot;R_COPY&quot;)</span>
<span class="sd">			5L</span>
<span class="sd">			&gt;&gt;&gt; arch.get_view_type_constant(&quot;ELF&quot;, &quot;NOT_HERE&quot;, 100)</span>
<span class="sd">			100L</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="k">return</span> <span class="n">core</span><span class="o">.</span><span class="n">BNGetBinaryViewTypeArchitectureConstant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">type_name</span><span class="p">,</span> <span class="n">const_name</span><span class="p">,</span> <span class="n">default_value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Architecture.set_view_type_constant"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.set_view_type_constant">[docs]</a>	<span class="k">def</span> <span class="nf">set_view_type_constant</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">type_name</span><span class="p">,</span> <span class="n">const_name</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``set_view_type_constant`` creates a new binaryview type constant.</span>

<span class="sd">		:param str type_name: the BinaryView type name of the constant to be registered</span>
<span class="sd">		:param str const_name: the constant name to register</span>
<span class="sd">		:param int value: the value of the constant</span>
<span class="sd">		:rtype: None</span>
<span class="sd">		:Example:</span>

<span class="sd">			&gt;&gt;&gt; ELF_RELOC_COPY = 5</span>
<span class="sd">			&gt;&gt;&gt; arch.set_view_type_constant(&quot;ELF&quot;, &quot;R_COPY&quot;, ELF_RELOC_COPY)</span>
<span class="sd">			&gt;&gt;&gt;</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">core</span><span class="o">.</span><span class="n">BNSetBinaryViewTypeArchitectureConstant</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">type_name</span><span class="p">,</span> <span class="n">const_name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="Architecture.register_calling_convention"><a class="viewcode-back" href="../../binaryninja.architecture-module.html#binaryninja.architecture.Architecture.register_calling_convention">[docs]</a>	<span class="k">def</span> <span class="nf">register_calling_convention</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">cc</span><span class="p">):</span>
		<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">		``register_calling_convention`` registers a new calling convention for the Architecture.</span>

<span class="sd">		:param CallingConvention cc: CallingConvention object to be registered</span>
<span class="sd">		:rtype: None</span>
<span class="sd">		&quot;&quot;&quot;</span>
		<span class="n">core</span><span class="o">.</span><span class="n">BNRegisterCallingConvention</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle</span><span class="p">,</span> <span class="n">cc</span><span class="o">.</span><span class="n">handle</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="ReferenceSource"><a class="viewcode-back" href="../../binaryninja.architecture.ReferenceSource.html#binaryninja.architecture.ReferenceSource">[docs]</a><span class="k">class</span> <span class="nc">ReferenceSource</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<div class="viewcode-block" id="ReferenceSource.__init__"><a class="viewcode-back" href="../../binaryninja.architecture.ReferenceSource.html#binaryninja.architecture.ReferenceSource.__init__">[docs]</a>	<span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">arch</span><span class="p">,</span> <span class="n">addr</span><span class="p">):</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">function</span> <span class="o">=</span> <span class="n">func</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">arch</span> <span class="o">=</span> <span class="n">arch</span>
		<span class="bp">self</span><span class="o">.</span><span class="n">address</span> <span class="o">=</span> <span class="n">addr</span></div>

	<span class="k">def</span> <span class="nf">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
		<span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="p">:</span>
			<span class="k">return</span> <span class="s2">&quot;&lt;ref: </span><span class="si">%s</span><span class="s2">@</span><span class="si">%#x</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arch</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">address</span><span class="p">)</span>
		<span class="k">else</span><span class="p">:</span>
			<span class="k">return</span> <span class="s2">&quot;&lt;ref: </span><span class="si">%#x</span><span class="s2">&gt;&quot;</span> <span class="o">%</span> <span class="bp">self</span><span class="o">.</span><span class="n">address</span></div>
</pre></div>

           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Vector 35 LLC.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>